(this.webpackJsonp=this.webpackJsonp||[]).push([[53],{"0A08":function A08(e,t,r){"use strict";r.r(t);var n,o,i,a,c=r("+7/b"),s=r("vRHA"),u=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var r=new Uint8Array(16);return t.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,e.decimalToHex(r[0])+e.decimalToHex(r[1])+e.decimalToHex(r[2])+e.decimalToHex(r[3])+"-"+e.decimalToHex(r[4])+e.decimalToHex(r[5])+"-"+e.decimalToHex(r[6])+e.decimalToHex(r[7])+"-"+e.decimalToHex(r[8])+e.decimalToHex(r[9])+"-"+e.decimalToHex(r[10])+e.decimalToHex(r[11])+e.decimalToHex(r[12])+e.decimalToHex(r[13])+e.decimalToHex(r[14])+e.decimalToHex(r[15]);}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,a="",c=0;c<36;c++){"-"!==n[c]&&"4"!==n[c]&&(i=16*Math.random()|0),"x"===n[c]?a+=o[i]:"y"===n[c]?(i&=3,a+=o[i|=8]):a+=n[c];}return a;},e.isGuid=function(e){return /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e);},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;){t="0"+t;}return t;},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(Number("0x"+t));}));},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string");}return decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2);}).join(""));},e.deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function o(e){return decodeURIComponent(e.replace(r," "));},i={};for(t=n.exec(e);t;){i[o(t[1])]=o(o(t[2])),t=n.exec(e);}return i;},e;}(),l=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function get(){return"Msal.js";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"claims",{get:function get(){return"claims";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function get(){return"clientId";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function get(){return"adal.idtoken";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function get(){return"msal";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scopes",{get:function get(){return"scopes";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function get(){return"NO_ACCOUNT";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function get(){return"upn";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function get(){return"domain_hint";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function get(){return"&prompt=select_account";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function get(){return"&prompt=none";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function get(){return"prompt";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function get(){return"&response_mode=fragment";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function get(){return"|";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function get(){return".";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function get(){return this._popUpWidth;},set:function set(e){this._popUpWidth=e;},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function get(){return this._popUpHeight;},set:function set(e){this._popUpHeight=e;},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function get(){return"LOGIN";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function get(){return"RENEW_TOKEN";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function get(){return"UNKNOWN";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function get(){return"homeAccountIdentifier";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function get(){return"common";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function get(){return"openid";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function get(){return"profile";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function get(){return"redirectInteraction";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function get(){return"popupInteraction";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function get(){return"silentInteraction";},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function get(){return"inProgress";},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e;}();!function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info";}(n||(n={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction_status",e.REDIRECT_REQUEST="redirect_request";}(o||(o={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info";}(i||(i={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description";}(a||(a={}));var d,h={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier";}(d||(d={}));var p=[d.SID,d.LOGIN_HINT],f={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},g="msalIdTokenFrame",m="msalRenewFrame";var y,v={code:"unexpected_error",desc:"Unexpected error in authentication."},I={code:"no_window_object",desc:"No window object available. Details:"},w=function(e){function t(r,n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o.errorCode=r,o.errorMessage=n,o.name="AuthError",o;}return c.__extends(t,e),t.createUnexpectedError=function(e){return new t(v.code,v.desc+": "+e);},t.createNoWindowObjectError=function(e){return new t(I.code,I.desc+" "+e);},t;}(Error),E=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length;},e;}(),T={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority."},_={code:"multiple_authorities",desc:"Multiple authorities found in the cache. Pass authority in the API overload."},b={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},S={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},C={code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},A={code:"invalid_id_token",desc:"Invalid ID token format."},k={code:"invalid_state_error",desc:"Invalid state."},R={code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},O={code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},P={code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},N={code:"user_cancelled",desc:"User cancelled the flow."},x={code:"callback_error",desc:"Error occurred in token received callback function."},U={code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},L={code:"user_non_existent",desc:"User object does not exist. Please call a login API."},q={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},D={code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},j={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},H={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},M={code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},F={code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},K={code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},G={code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"},W=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o;}return c.__extends(t,e),t.createEndpointResolutionError=function(e){var r=b.desc;return e&&!E.isEmpty(e)&&(r+=" Details: "+e),new t(b.code,r);},t.createMultipleMatchingTokensInCacheError=function(e){return new t(T.code,"Cache error for scope "+e+": "+T.desc+".");},t.createMultipleAuthoritiesInCacheError=function(e){return new t(_.code,"Cache error for scope "+e+": "+_.desc+".");},t.createPopupWindowError=function(e){var r=S.desc;return e&&!E.isEmpty(e)&&(r+=" Details: "+e),new t(S.code,r);},t.createTokenRenewalTimeoutError=function(e){var r="URL navigated to is "+e+", "+C.desc;return new t(C.code,r);},t.createInvalidIdTokenError=function(e){return new t(A.code,A.desc+" Given token: "+e);},t.createInvalidStateError=function(e,r){return new t(k.code,k.desc+" "+e+", state expected : "+r+".");},t.createNonceMismatchError=function(e,r){return new t(R.code,R.desc+" "+e+", nonce expected : "+r+".");},t.createLoginInProgressError=function(){return new t(O.code,O.desc);},t.createAcquireTokenInProgressError=function(){return new t(P.code,P.desc);},t.createUserCancelledError=function(){return new t(N.code,N.desc);},t.createErrorInCallbackFunction=function(e){return new t(x.code,x.desc+" "+e+".");},t.createUserLoginRequiredError=function(){return new t(U.code,U.desc);},t.createUserDoesNotExistError=function(){return new t(L.code,L.desc);},t.createClientInfoDecodingError=function(e){return new t(q.code,q.desc+" Failed with error: "+e);},t.createClientInfoNotPopulatedError=function(e){return new t(D.code,D.desc+" Failed with error: "+e);},t.createIdTokenNullOrEmptyError=function(e){return new t(j.code,j.desc+" Raw ID Token Value: "+e);},t.createIdTokenParsingError=function(e){return new t(H.code,H.desc+" Failed with error: "+e);},t.createTokenEncodingError=function(e){return new t(M.code,M.desc+" Attempted to decode: "+e);},t.createInvalidInteractionTypeError=function(){return new t(F.code,F.desc);},t.createCacheParseError=function(e){var r="invalid key: "+e+", "+K.desc;return new t(K.code,r);},t.createBlockTokenRequestsInHiddenIframeError=function(){return new t(G.code,G.desc);},t;}(w),Q={code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},V={code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},J={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},B={code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},z={code:"scopes_required",desc:"Scopes are required to obtain an access token."},X={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},Y={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},$={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},Z={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},ee={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},te={code:"authority_uri_insecure",desc:"Authority URIs must use https."},re={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},ne={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. If using B2C, please include this authority in the knownAuthorities config parameter."},oe={code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},ie={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},ae={code:"empty_request_error",desc:"Request object is required."},ce={code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},se={code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},ue={code:"sso_silent_error",desc:"request must contain either sid or login_hint"},le=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o;}return c.__extends(t,e),t.createNoSetConfigurationError=function(){return new t(Q.code,""+Q.desc);},t.createStorageNotSupportedError=function(e){return new t(V.code,V.desc+" Given location: "+e);},t.createRedirectCallbacksNotSetError=function(){return new t(J.code,J.desc);},t.createInvalidCallbackObjectError=function(e){return new t(B.code,B.desc+" Given value for callback function: "+e);},t.createEmptyScopesArrayError=function(e){return new t(X.code,X.desc+" Given value: "+e+".");},t.createScopesNonArrayError=function(e){return new t(Y.code,Y.desc+" Given value: "+e+".");},t.createClientIdSingleScopeError=function(e){return new t($.code,$.desc+" Given value: "+e+".");},t.createScopesRequiredError=function(e){return new t(z.code,z.desc+" Given value: "+e);},t.createInvalidPromptError=function(e){return new t(Z.code,Z.desc+" Given value: "+e);},t.createClaimsRequestParsingError=function(e){return new t(ie.code,ie.desc+" Given value: "+e);},t.createEmptyRequestError=function(){var e=ae;return new t(e.code,e.desc);},t.createInvalidCorrelationIdError=function(){return new t(ce.code,ce.desc);},t.createKnownAuthoritiesNotSetError=function(){return new t(oe.code,oe.desc);},t.createInvalidAuthorityTypeError=function(){return new t(ee.code,ee.desc);},t.createUntrustedAuthorityError=function(){return new t(ne.code,ne.desc);},t.createTelemetryConfigError=function(e){var r=se,n=r.code,o=r.desc,i={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(n,o+" mising values: "+Object.keys(i).reduce(function(t,r){return e[r]?t:t.concat([r+" ("+i[r]+")"]);},[]).join(","));},t.createSsoSilentError=function(){return new t(ue.code,ue.desc);},t;}(W),de=function(){function e(){}return e.isIntersectingScopes=function(e,t){e=this.convertToLowerCase(e);for(var r=0;r<t.length;r++){if(e.indexOf(t[r].toLowerCase())>-1)return!0;}return!1;},e.containsScope=function(e,t){return e=this.convertToLowerCase(e),t.every(function(t){return e.indexOf(t.toString().toLowerCase())>=0;});},e.convertToLowerCase=function(e){return e.map(function(e){return e.toLowerCase();});},e.removeElement=function(e,t){return e.filter(function(e){return e!==t;});},e.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r){t+=r!==e.length-1?e[r]+" ":e[r];}return t;},e.validateInputScope=function(e,t,r){if(e){if(!Array.isArray(e))throw le.createScopesNonArrayError(e);if(e.length<1)throw le.createEmptyScopesArrayError(e.toString());if(e.indexOf(r)>-1&&e.length>1)throw le.createClientIdSingleScopeError(e.toString());}else if(t)throw le.createScopesRequiredError(e);},e.getScopeFromState=function(e){if(e){var t=e.indexOf(l.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1);}return"";},e.appendScopes=function(e,t){return e?t?e.concat(t):e:null;},e;}(),he=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&");},e.createNavigationUrlString=function(e){var t=e.scopes;-1===t.indexOf(e.clientId)&&t.push(e.clientId);var r=[];return r.push("response_type="+e.responseType),this.translateclientIdUsedInScope(t,e.clientId),r.push("scope="+encodeURIComponent(de.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r;},e.translateclientIdUsedInScope=function(e,t){var r=e.indexOf(t);r>=0&&(e.splice(r,1),-1===e.indexOf("openid")&&e.push("openid"),-1===e.indexOf("profile")&&e.push("profile"));},e.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0];},e.replaceTenantPath=function(e,t){e=e.toLowerCase();var r=this.GetUrlComponents(e),n=r.PathSegments;return t&&0!==n.length&&n[0]===l.common&&(n[0]=t),this.constructAuthorityUriFromObject(r,n);},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"));},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter(function(e){return e&&e.length>0;}),n.PathSegments=o,n;},e.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!e.endsWith(t,"/")&&(t+="/"),t;},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length);},e.urlRemoveQueryStringParameter=function(e,t){if(E.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e=e.replace(r,"");},e.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e;},e.urlContainsHash=function(t){var r=e.deserializeHash(t);return r.hasOwnProperty(n.ERROR_DESCRIPTION)||r.hasOwnProperty(n.ERROR)||r.hasOwnProperty(n.ACCESS_TOKEN)||r.hasOwnProperty(n.ID_TOKEN);},e.deserializeHash=function(t){var r=e.getHashFromUrl(t);return u.deserialize(r);},e.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0];},e;}(),pe=function pe(e,t,r,n,o){this.authority=he.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=u.base64Encode(n)+"."+u.base64Encode(o);},fe=function fe(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n;},ge=function(){function e(e,t,r,n,o,i,a){this.authorityInstance=e,this.clientId=t,this.nonce=u.createNewGuid(),this.scopes=o?o.slice():[t],this.state=i,this.correlationId=a,this.xClientSku="MSAL.JS",this.xClientVer="1.3.0",this.responseType=r,this.redirectUri=n;}return Object.defineProperty(e.prototype,"authority",{get:function get(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null;},enumerable:!0,configurable:!0}),e.prototype.populateQueryParams=function(t,r,n,o){var i={};r&&(r.prompt&&(this.promptValue=r.prompt),r.claimsRequest&&(this.claimsValue=r.claimsRequest),e.isSSOParam(r)&&(i=this.constructUnifiedCacheQueryParameter(r,null))),n&&(i=this.constructUnifiedCacheQueryParameter(null,n)),i=this.addHintParameters(t,i);var a=r?r.extraQueryParameters:null;this.queryParameters=e.generateQueryParametersString(i),this.extraQueryParameters=e.generateQueryParametersString(a,o);},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,n;if(e){if(e.account){var o=e.account;o.sid?(r=d.SID,n=o.sid):o.userName&&(r=d.LOGIN_HINT,n=o.userName);}else e.sid?(r=d.SID,n=e.sid):e.loginHint&&(r=d.LOGIN_HINT,n=e.loginHint);}else t&&t.hasOwnProperty(l.upn)&&(r=d.ID_TOKEN,n=t.upn);return this.addSSOParameter(r,n);},e.prototype.addHintParameters=function(e,t){e&&!t[d.SID]&&(!t[d.LOGIN_HINT]&&e.sid&&this.promptValue===f.NONE?t=this.addSSOParameter(d.SID,e.sid,t):!t[d.LOGIN_HINT]&&e.userName&&!E.isEmpty(e.userName)&&(t=this.addSSOParameter(d.LOGIN_HINT,e.userName,t)));return t;},e.prototype.addSSOParameter=function(e,t,r){if(r||(r={}),!t)return r;switch(e){case d.SID:r[d.SID]=t;break;case d.ID_TOKEN:case d.LOGIN_HINT:r[d.LOGIN_HINT]=t;}return r;},e.generateQueryParametersString=function(e,t){var r=null;return e&&Object.keys(e).forEach(function(n){n===l.domain_hint&&(t||e[d.SID])||(null==r?r=n+"="+encodeURIComponent(e[n]):r+="&"+n+"="+encodeURIComponent(e[n]));}),r;},e.isSSOParam=function(e){return e&&(e.account||e.sid||e.loginHint);},e;}(),me=function(){function e(e){if(!e||E.isEmpty(e))return this.uid="",void(this.utid="");try{var t=u.base64Decode(e),r=JSON.parse(t);r&&(r.hasOwnProperty("uid")&&(this.uid=r.uid),r.hasOwnProperty("utid")&&(this.utid=r.utid));}catch(e){throw W.createClientInfoDecodingError(e);}}return Object.defineProperty(e.prototype,"uid",{get:function get(){return this._uid?this._uid:"";},set:function set(e){this._uid=e;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function get(){return this._utid?this._utid:"";},set:function set(e){this._utid=e;},enumerable:!0,configurable:!0}),e;}(),ye=function(){function e(){}return e.decodeJwt=function(e){if(E.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]};},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,n=u.base64Decode(r);return n?JSON.parse(n):null;}catch(e){}return null;},e;}(),ve=function ve(e){if(E.isEmpty(e))throw W.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=ye.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")&&(this.preferredName=this.claims.preferred_username),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name));}catch(e){throw W.createIdTokenParsingError(e);}},Ie=function Ie(e,t){this.key=e,this.value=t;},we=function(e){function t(t,r,n){var o=e.call(this,r)||this;return o.clientId=t,o.rollbackEnabled=!0,o.migrateCacheEntries(n),o;}return c.__extends(t,e),t.prototype.migrateCacheEntries=function(t){var r=this,n=l.cachePrefix+"."+i.IDTOKEN,o=l.cachePrefix+"."+i.CLIENT_INFO,c=l.cachePrefix+"."+a.ERROR,s=l.cachePrefix+"."+a.ERROR_DESC,u=[e.prototype.getItem.call(this,n),e.prototype.getItem.call(this,o),e.prototype.getItem.call(this,c),e.prototype.getItem.call(this,s)];[i.IDTOKEN,i.CLIENT_INFO,a.ERROR,a.ERROR_DESC].forEach(function(e,n){return r.duplicateCacheEntry(e,u[n],t);});},t.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r);},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e;}catch(r){return 0===e.indexOf(""+l.cachePrefix)||0===e.indexOf(l.adalIdToken)?e:t?l.cachePrefix+"."+this.clientId+"."+e:l.cachePrefix+"."+e;}},t.prototype.setItem=function(t,r,n,o){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),r,n);},t.prototype.getItem=function(t,r){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),r);},t.prototype.removeItem=function(t){e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1));},t.prototype.resetCacheItems=function(){var t,r=window[this.cacheLocation];for(t in r){r.hasOwnProperty(t)&&-1!==t.indexOf(l.cachePrefix)&&e.prototype.removeItem.call(this,t);}},t.prototype.resetTempCacheItems=function(e){var t,r=window[this.cacheLocation];for(t in r){e&&-1===t.indexOf(e)||this.tokenRenewalInProgress(e)||(this.removeItem(t),this.setItemCookie(t,"",-1),this.clearMsalCookie(e));}this.removeItem(o.INTERACTION_STATUS),this.removeItem(o.REDIRECT_REQUEST);},t.prototype.setItemCookie=function(t,r,n){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),r,n);},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0));},t.prototype.getAllAccessTokens=function(e,t){var r=this;return Object.keys(window[this.cacheLocation]).reduce(function(n,o){if(o.match(e)&&o.match(t)&&o.match(l.scopes)){var i=r.getItem(o);if(i)try{var a=JSON.parse(o),c=new Ie(a,JSON.parse(i));return n.concat([c]);}catch(e){throw W.createCacheParseError(o);}}return n;},[]);},t.prototype.tokenRenewalInProgress=function(e){var t=this.getItem(o.RENEW_STATUS+"|"+e);return!(!t||t!==l.inProgress);},t.prototype.clearMsalCookie=function(e){this.clearItemCookie(o.NONCE_IDTOKEN+"|"+e),this.clearItemCookie(o.STATE_LOGIN+"|"+e),this.clearItemCookie(o.LOGIN_REQUEST+"|"+e),this.clearItemCookie(o.STATE_ACQ_TOKEN+"|"+e);},t.generateAcquireTokenAccountKey=function(e,t){return""+o.ACQUIRE_TOKEN_ACCOUNT+l.resourceDelimiter+e+l.resourceDelimiter+t;},t.generateAuthorityKey=function(e){return""+o.AUTHORITY+l.resourceDelimiter+e;},t;}(function(){function e(e){if(!window)throw w.createNoWindowObjectError("Browser storage class could not find window object");if(!(void 0!==window[e]&&null!=window[e]))throw le.createStorageNotSupportedError(e);this.cacheLocation=e;}return e.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t);},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e);},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e);},e.prototype.clear=function(){return window[this.cacheLocation].clear();},e.prototype.setItemCookie=function(e,t,r){var n=e+"="+t+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");document.cookie=n;},e.prototype.getItemCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);){o=o.substring(1);}if(0===o.indexOf(t))return o.substring(t.length,o.length);}return"";},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1);},e.prototype.getCookieExpirationTime=function(e){var t=new Date();return new Date(t.getTime()+24*e*60*60*1e3).toUTCString();},e;}()),Ee=function(){function e(e,t,r,n,o,i,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=o,this.idTokenClaims=o,this.sid=i,this.environment=a;}return e.createAccount=function(t,r){var n,o=t.objectId||t.subject,i=r?r.uid:"",a=r?r.utid:"";return E.isEmpty(i)||E.isEmpty(a)||(n=u.base64Encode(i)+"."+u.base64Encode(a)),new e(o,n,t.preferredName,t.name,t.claims,t.sid,t.issuer);},e.compareAccounts=function(e,t){return!(!e||!t)&&!(!e.homeAccountIdentifier||!t.homeAccountIdentifier||e.homeAccountIdentifier!==t.homeAccountIdentifier);},e;}(),Te=function(){function e(){}return e.isInIframe=function(){return window.parent!==window;},e.isInPopup=function(){return!(!window.opener||window.opener===window);},e.generateFrameName=function(e,t){return""+e+l.resourceDelimiter+t;},e.monitorWindowForHash=function(t,r,n,o){return new Promise(function(i,a){var c=r/e.POLLING_INTERVAL_MS,s=0,u=setInterval(function(){if(t.closed)return clearInterval(u),void a(W.createUserCancelledError());var e;try{e=t.location.href;}catch(e){}if(o)s++;else{if(!e||"about:blank"===e)return;s++;}e&&he.urlContainsHash(e)?(clearInterval(u),i(t.location.hash)):s>c&&(clearInterval(u),a(W.createTokenRenewalTimeoutError(n)));},e.POLLING_INTERVAL_MS);});},e.loadFrame=function(e,t,r,n){var o=this;return n.info("LoadFrame: "+t),new Promise(function(i,a){setTimeout(function(){var r=o.loadFrameSync(e,t,n);r?i(r):a("Unable to load iframe with name: "+t);},r);});},e.loadFrameSync=function(t,r,n){var o=e.addHiddenIFrame(r,n);return o?(""!==o.src&&"about:blank"!==o.src||(o.src=t,n.infoPii("Frame Name : "+r+" Navigated to: "+t)),o):null;},e.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.info("Add msal frame to document:"+e);var r=document.getElementById(e);if(!r){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var n=document.createElement("iframe");n.setAttribute("id",e),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),r=document.getElementsByTagName("body")[0].appendChild(n);}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(r=window.frames[e]);}return r;},e.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e);},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map(function(e,r){return t.item(r);}).filter(function(t){try{return t.contentWindow.location.hash===e;}catch(e){return!1;}})[0];},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows;},e.getPopUpWithHash=function(t){return e.getPopups().filter(function(e){try{return e.location.hash===t;}catch(e){return!1;}})[0];},e.trackPopup=function(t){e.getPopups().push(t);},e.closePopups=function(){e.getPopups().forEach(function(e){return e.close();});},e.blockReloadInHiddenIframes=function(){if(he.urlContainsHash(window.location.hash)&&e.isInIframe())throw W.createBlockTokenRequestsInHiddenIframeError();},e.checkIfBackButtonIsPressed=function(e){var t=e.getItem(o.REDIRECT_REQUEST);if(t&&!he.urlContainsHash(window.location.hash)){var r=t.split(l.resourceDelimiter),n=r.length>1?r[r.length-1]:null;e.resetTempCacheItems(n);}},e.POLLING_INTERVAL_MS=50,e;}(),_e=function(){function e(){}return e.parseExpiresIn=function(e){return e||(e="3599"),parseInt(e,10);},e.now=function(){return Math.round(new Date().getTime()/1e3);},e;}(),be=function(){function e(){}return e.validateRequest=function(e,t,r,n){if(!t&&!e)throw le.createEmptyRequestError();var o,i;e&&(o=t?de.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,de.validateInputScope(o,!t,r),this.validatePromptParameter(e.prompt),i=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var a=this.validateAndGenerateState(e&&e.state,n),s=this.validateAndGenerateCorrelationId(e&&e.correlationId);return c.__assign({},e,{extraQueryParameters:i,scopes:o,state:a,correlationId:s});},e.validatePromptParameter=function(e){if(e&&[f.LOGIN,f.SELECT_ACCOUNT,f.CONSENT,f.NONE].indexOf(e)<0)throw le.createInvalidPromptError(e);},e.validateEQParameters=function(e,t){var r=c.__assign({},e);return r?(t&&delete r[l.claims],p.forEach(function(e){r[e]&&delete r[e];}),r):null;},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e);}catch(e){throw le.createClaimsRequestParsingError(e);}},e.validateAndGenerateState=function(t,r){return E.isEmpty(t)?e.generateLibraryState(r):""+e.generateLibraryState(r)+l.resourceDelimiter+t;},e.generateLibraryState=function(e){var t={id:u.createNewGuid(),ts:_e.now(),method:e},r=JSON.stringify(t);return u.base64Encode(r);},e.parseLibraryState=function(e){var t=decodeURIComponent(e).split(l.resourceDelimiter)[0];if(u.isGuid(t))return{id:t,ts:_e.now(),method:l.interactionTypeRedirect};try{var r=u.base64Decode(t);return JSON.parse(r);}catch(t){throw W.createInvalidStateError(e,null);}},e.validateAndGenerateCorrelationId=function(e){if(e&&!u.isGuid(e))throw le.createInvalidCorrelationIdError();return u.isGuid(e)?e:u.createNewGuid();},e.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+l.resourceDelimiter+e.authority;},e;}(),Se=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),c.__assign({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId});},e;}(),Ce=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise(function(r,o){var i=new XMLHttpRequest();if(i.open(t,e,!0),i.onload=function(e){var t;(i.status<200||i.status>=300)&&o(n.handleError(i.responseText));try{t=JSON.parse(i.responseText);}catch(e){o(n.handleError(i.responseText));}var a={statusCode:i.status,body:t};r(a);},i.onerror=function(e){o(i.status);},"GET"!==t)throw"not implemented";i.send();});},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e;}catch(t){return e;}},e;}(),Ae="Microsoft.MSAL.correlation_id",ke="msal.api_telem_id",Re="msal.api_id",Oe="Microsoft_MSAL_cache_event_count",Pe="Microsoft_MSAL_http_event_count",Ne="Microsoft_MSAL_ui_event_count",xe=function xe(e){var t=he.GetUrlComponents(e);if(!h[t.HostNameAndPort.toLocaleLowerCase()])return e;var r=t.PathSegments;if(r&&r.length>=2){var n="tfp"===r[1]?2:1;n<r.length&&(r[n]="<tenant>");}return t.Protocol+"//"+t.HostNameAndPort+"/"+r.join("/");},Ue=function Ue(e){return u.base64Encode(e);},Le=function Le(e){return"msal."+(e||"");},qe=function(){function e(e,t){var r;this.startTimestamp=Date.now(),this.eventId=u.createNewGuid(),this.event=((r={})[Le("event_name")]=e,r[Le("start_time")]=this.startTimestamp,r[Le("elapsed_time")]=-1,r[""+Ae]=t,r);}return e.prototype.setElapsedTime=function(e){this.event[Le("elapsed_time")]=e;},e.prototype.stop=function(){this.setElapsedTime(+Date.now()-+this.startTimestamp);},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function get(){return this.event[""+Ae];},set:function set(e){this.event[""+Ae]=e;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function get(){return this.event[Le("event_name")];},enumerable:!0,configurable:!0}),e.prototype.get=function(){return c.__assign({},this.event,{eventId:this.eventId});},e;}(),De=Le("http_path"),je=Le("user_agent"),He=Le("query_parameters"),Me=Le("api_version"),Fe=Le("response_code"),Ke=Le("oauth_error_code"),Ge=Le("http_method"),We=Le("request_id_header"),Qe=Le("spe_info"),Ve=Le("server_error_code"),Je=Le("server_sub_error_code"),Be=Le("url"),ze=function(e){function t(t){return e.call(this,Le("http_event"),t)||this;}return c.__extends(t,e),Object.defineProperty(t.prototype,"url",{set:function set(e){var t=xe(e);this.event[Be]=t&&t.toLowerCase();},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpPath",{set:function set(e){this.event[De]=xe(e).toLowerCase();},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userAgent",{set:function set(e){this.event[je]=e;},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryParams",{set:function set(e){this.event[He]=ge.generateQueryParametersString(e);},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiVersion",{set:function set(e){this.event[Me]=e.toLowerCase();},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{set:function set(e){this.event[Fe]=e;},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"oAuthErrorCode",{set:function set(e){this.event[Ke]=e;},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{set:function set(e){this.event[Ge]=e;},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestIdHeader",{set:function set(e){this.event[We]=e;},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speInfo",{set:function set(e){this.event[Qe]=e;},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{set:function set(e){this.event[Ve]=e;},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverSubErrorCode",{set:function set(e){this.event[Je]=e;},enumerable:!0,configurable:!0}),t;}(qe);!function(e){e[e.Aad=0]="Aad",e[e.Adfs=1]="Adfs",e[e.B2C=2]="B2C";}(y||(y={}));var Xe,Ye=function(){function e(e,t){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri();}return Object.defineProperty(e.prototype,"Tenant",{get:function get(){return this.CanonicalAuthorityUrlComponents.PathSegments[0];},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function get(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant);},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function get(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant);},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function get(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant);},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.tenantDiscoveryResponse)throw"Please call ResolveEndpointsAsync first";},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function get(){return this.canonicalAuthority;},set:function set(e){this.canonicalAuthority=he.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function get(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=he.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function get(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration";},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents;}catch(e){throw ee;}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw te;if(!e.PathSegments||e.PathSegments.length<1)throw re;},e.prototype.DiscoverEndpoints=function(e,t,r){var n=new Ce(),o=new ze(r);return o.url=e,o.httpMethod="GET",t.startEvent(o),n.sendRequestAsync(e,"GET",!0).then(function(e){return o.httpResponseStatus=e.statusCode,t.stopEvent(o),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer};}).catch(function(e){throw o.serverErrorCode=e,t.stopEvent(o),e;});},e.prototype.resolveEndpointsAsync=function(e,t){return c.__awaiter(this,void 0,void 0,function(){var r,n;return c.__generator(this,function(o){switch(o.label){case 0:return[4,this.GetOpenIdConfigurationEndpointAsync(e,t)];case 1:return r=o.sent(),n=this,[4,this.DiscoverEndpoints(r,e,t)];case 2:return n.tenantDiscoveryResponse=o.sent(),[2,this];}});});},e;}(),$e=function(e){function t(t,r){return e.call(this,t,r)||this;}return c.__extends(t,e),Object.defineProperty(t.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function get(){return t.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize";},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AuthorityType",{get:function get(){return y.Aad;},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(e,t){return c.__awaiter(this,void 0,void 0,function(){var r,n;return c.__generator(this,function(o){return!this.IsValidationEnabled||this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?[2,this.DefaultOpenIdConfigurationEndpoint]:(r=new Ce(),"GET",n=e.createAndStartHttpEvent(t,"GET",this.AadInstanceDiscoveryEndpointUrl),[2,r.sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then(function(t){return n.httpResponseStatus=t.statusCode,e.stopEvent(n),t.body.tenant_discovery_endpoint;}).catch(function(t){throw n.serverErrorCode=t,e.stopEvent(n),t;})]);});});},t.prototype.IsInTrustedHostList=function(e){return h[e.toLowerCase()];},t.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",t;}(Ye),Ze={},et=function(e){function t(t,r){return e.call(this,t,r)||this;}return c.__extends(t,e),Object.defineProperty(t.prototype,"AuthorityType",{get:function get(){return y.B2C;},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(){return c.__awaiter(this,void 0,void 0,function(){return c.__generator(this,function(e){if(!this.IsValidationEnabled||this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort))return[2,this.DefaultOpenIdConfigurationEndpoint];throw le.createUntrustedAuthorityError();});});},t.prototype.IsInTrustedHostList=function(e){if(this.IsValidationEnabled&&!Object.keys(Ze).length)throw le.createKnownAuthoritiesNotSetError();return Ze[e.toLowerCase()];},t.B2C_PREFIX="tfp",t;}(Ye),tt=function(){function e(){}return e.setKnownAuthorities=function(e,t){e&&!Object.keys(Ze).length&&t.forEach(function(e){Ze[e]=e;});},e.detectAuthorityFromUrl=function(e){return e=he.CanonicalizeUri(e),"adfs"===he.GetUrlComponents(e).PathSegments[0]?y.Adfs:Object.keys(Ze).length?y.B2C:y.Aad;},e.CreateInstance=function(t,r){if(E.isEmpty(t))return null;switch(e.detectAuthorityFromUrl(t)){case y.B2C:return new et(t,r);case y.Aad:return new $e(t,r);default:throw le.createInvalidAuthorityTypeError();}},e;}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose";}(Xe||(Xe={}));var rt=function(){function e(e,t){void 0===t&&(t={}),this.level=Xe.Info;var r=t.correlationId,n=void 0===r?"":r,o=t.level,i=void 0===o?Xe.Info:o,a=t.piiLoggingEnabled,c=void 0!==a&&a;this.localCallback=e,this.correlationId=n,this.level=i,this.piiLoggingEnabled=c;}return e.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var n,o=new Date().toUTCString();n=E.isEmpty(this.correlationId)?o+":1.3.0-"+Xe[e]+" "+t:o+":"+this.correlationId+"-1.3.0-"+Xe[e]+" "+t,this.executeCallback(e,n,r);}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r);},e.prototype.error=function(e){this.logMessage(Xe.Error,e,!1);},e.prototype.errorPii=function(e){this.logMessage(Xe.Error,e,!0);},e.prototype.warning=function(e){this.logMessage(Xe.Warning,e,!1);},e.prototype.warningPii=function(e){this.logMessage(Xe.Warning,e,!0);},e.prototype.info=function(e){this.logMessage(Xe.Info,e,!1);},e.prototype.infoPii=function(e){this.logMessage(Xe.Info,e,!0);},e.prototype.verbose=function(e){this.logMessage(Xe.Verbose,e,!1);},e.prototype.verbosePii=function(e){this.logMessage(Xe.Verbose,e,!0);},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled;},e;}(),nt={clientId:"",authority:null,validateAuthority:!0,knownAuthorities:[],redirectUri:function redirectUri(){return he.getCurrentUrl();},postLogoutRedirectUri:function postLogoutRedirectUri(){return he.getCurrentUrl();},navigateToLoginRequestUrl:!0},ot={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},it={logger:new rt(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},at={isAngular:!1,unprotectedResources:new Array(),protectedResourceMap:new Map()};var ct={code:"server_unavailable",desc:"Server is temporarily unavailable."},st={code:"unknown_server_error"},ut=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ServerError",Object.setPrototypeOf(o,t.prototype),o;}return c.__extends(t,e),t.createServerUnavailableError=function(){return new t(ct.code,ct.desc);},t.createUnknownServerError=function(e){return new t(st.code,e);},t;}(w),lt={code:"interaction_required"},dt={code:"consent_required"},ht={code:"login_required"},pt=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,t.prototype),o;}return c.__extends(t,e),t.isInteractionRequiredError=function(e){var t=[lt.code,dt.code,ht.code];return e&&t.indexOf(e)>-1;},t.createLoginRequiredAuthError=function(e){return new t(ht.code,e);},t.createInteractionRequiredAuthError=function(e){return new t(lt.code,e);},t.createConsentRequiredAuthError=function(e){return new t(dt.code,e);},t;}(ut);function ft(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1};}var gt,mt,yt,vt=function(e){function t(t,r,n,o){var i=e.call(this,Le("default_event"),r)||this;return i.event[Le("client_id")]=n,i.event[Le("sdk_plaform")]=t.sdk,i.event[Le("sdk_version")]=t.sdkVersion,i.event[Le("application_name")]=t.applicationName,i.event[Le("application_version")]=t.applicationVersion,i.event[Le("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,i.event[""+Ne]=i.getEventCount(Le("ui_event"),o),i.event[""+Pe]=i.getEventCount(Le("http_event"),o),i.event[""+Oe]=i.getEventCount(Le("cache_event"),o),i;}return c.__extends(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0;},t;}(qe),It=Le("authority"),wt=Le("authority_type"),Et=Le("ui_behavior"),Tt=Le("tenant_id"),_t=Le("user_id"),bt=Le("was_successful"),St=Le("api_error_code"),Ct=Le("login_hint");!function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout";}(mt||(mt={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout";}(yt||(yt={}));var At=((gt={})[yt.AcquireTokenSilent]=mt.AcquireTokenSilent,gt[yt.AcquireTokenPopup]=mt.AcquireTokenPopup,gt[yt.AcquireTokenRedirect]=mt.AcquireTokenRedirect,gt[yt.LoginPopup]=mt.LoginPopup,gt[yt.LoginRedirect]=mt.LoginRedirect,gt[yt.Logout]=mt.Logout,gt),kt=function(e){function t(t,r,n){var o=e.call(this,Le("api_event"),t)||this;return n&&(o.apiCode=At[n],o.apiEventIdentifier=n),o.logger=r,o;}return c.__extends(t,e),Object.defineProperty(t.prototype,"apiEventIdentifier",{set:function set(e){this.event[ke]=e;},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiCode",{set:function set(e){this.event[Re]=e;},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authority",{set:function set(e){this.event[It]=xe(e).toLowerCase();},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiErrorCode",{set:function set(e){this.event[St]=e;},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tenantId",{set:function set(e){this.event[Tt]=this.logger.isPiiLoggingEnabled()&&e?Ue(e):null;},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accountId",{set:function set(e){this.event[_t]=this.logger.isPiiLoggingEnabled()&&e?Ue(e):null;},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasSuccessful",{get:function get(){return!0===this.event[bt];},set:function set(e){this.event[bt]=e;},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loginHint",{set:function set(e){this.event[Ct]=this.logger.isPiiLoggingEnabled()&&e?Ue(e):null;},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorityType",{set:function set(e){this.event[wt]=e.toLowerCase();},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promptType",{set:function set(e){this.event[Et]=e.toLowerCase();},enumerable:!0,configurable:!0}),t;}(qe),Rt=function Rt(e){return e.telemetryCorrelationId+"-"+e.eventId+"-"+e.eventName;},Ot=function(){function e(e,t){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=c.__assign({sdk:l.libraryName,sdkVersion:"1.3.0",networkInformation:{connectionSpeed:navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t;}return e.getTelemetrymanagerStub=function(e){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},function(){});},e.prototype.startEvent=function(e){if(this.telemetryEmitter){var t=Rt(e);this.inProgressEvents[t]=e;}},e.prototype.stopEvent=function(e){var t=Rt(e);if(this.telemetryEmitter&&this.inProgressEvents[t]){e.stop(),this.incrementEventCount(e);var r=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(r||[]).concat([e]),delete this.inProgressEvents[t];}},e.prototype.flush=function(e){var t=this;if(this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach(function(e){return t.incrementEventCount(e);});var n=this.completedEvents[e].concat(r);delete this.completedEvents[e];var o=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],n&&n.length){var i=new vt(this.telemetryPlatform,e,this.clientId,o),a=n.concat([i]);this.telemetryEmitter(a.map(function(e){return e.get();}));}}},e.prototype.createAndStartApiEvent=function(e,t,r){var n=new kt(e,r,t);return this.startEvent(n),n;},e.prototype.stopAndFlushApiEvent=function(e,t,r,n){t.wasSuccessful=r,n&&(t.apiErrorCode=n),this.stopEvent(t),this.flush(e);},e.prototype.createAndStartHttpEvent=function(e,t,r){console.log(r);var n=new ze(e);return n.url=r,n.httpMethod=t,this.startEvent(n),n;},e.prototype.incrementEventCount=function(e){var t,r=e.eventName,n=this.eventCountByCorrelationId[e.telemetryCorrelationId];n?n[r]=n[r]?n[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t);},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce(function(r,n){if(-1!==n.indexOf(e)){var o=t.inProgressEvents[n];return delete t.inProgressEvents[n],r.concat([o]);}return r;},[]);},e;}(),Pt="id_token",Nt="token",xt="id_token token",Ut=function(){function e(e){var t,r,n,o,i,a,s,u;this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=(r=(t=e).auth,n=t.cache,o=void 0===n?{}:n,i=t.system,a=void 0===i?{}:i,s=t.framework,u=void 0===s?{}:s,{auth:c.__assign({},nt,r),cache:c.__assign({},ot,o),system:c.__assign({},it,a),framework:c.__assign({},at,u)}),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),tt.setKnownAuthorities(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new we(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var d=window.location.hash,h=he.urlContainsHash(d);(Te.checkIfBackButtonIsPressed(this.cacheStorage),h)&&this.getResponseState(d).method===l.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(d);}return Object.defineProperty(e.prototype,"authority",{get:function get(){return this.authorityInstance.CanonicalAuthority;},set:function set(e){this.authorityInstance=tt.CreateInstance(e,this.config.auth.validateAuthority);},enumerable:!0,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance;},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw le.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(l.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(l.interactionTypeRedirect,this.redirectResponse);},e.prototype.urlContainsHash=function(e){return he.urlContainsHash(e);},e.prototype.authResponseHandler=function(e,t,r){if(e===l.interactionTypeRedirect)this.errorReceivedCallback?this.tokenReceivedCallback(t):this.authResponseCallback&&this.authResponseCallback(null,t);else{if(e!==l.interactionTypePopup)throw W.createInvalidInteractionTypeError();r(t);}},e.prototype.authErrorHandler=function(e,t,r,n){if(this.cacheStorage.removeItem(o.INTERACTION_STATUS),e===l.interactionTypeRedirect)this.errorReceivedCallback?this.errorReceivedCallback(t,r.accountState):this.authResponseCallback(t,r);else{if(e!==l.interactionTypePopup)throw W.createInvalidInteractionTypeError();n(t);}},e.prototype.loginRedirect=function(e){var t=be.validateRequest(e,!0,this.clientId,l.interactionTypeRedirect);this.acquireTokenInteractive(l.interactionTypeRedirect,!0,t,null,null);},e.prototype.acquireTokenRedirect=function(e){var t=be.validateRequest(e,!1,this.clientId,l.interactionTypeRedirect);this.acquireTokenInteractive(l.interactionTypeRedirect,!1,t,null,null);},e.prototype.loginPopup=function(e){var t=this,r=be.validateRequest(e,!0,this.clientId,l.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,yt.LoginPopup,this.logger);return new Promise(function(e,n){t.acquireTokenInteractive(l.interactionTypePopup,!0,r,e,n);}).then(function(e){return t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e;}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e;});},e.prototype.acquireTokenPopup=function(e){var t=this,r=be.validateRequest(e,!1,this.clientId,l.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,yt.AcquireTokenPopup,this.logger);return new Promise(function(e,n){t.acquireTokenInteractive(l.interactionTypePopup,!1,r,e,n);}).then(function(e){return t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e;}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e;});},e.prototype.acquireTokenInteractive=function(e,t,r,n,i){var a=this;Te.blockReloadInHiddenIframes();var c=this.cacheStorage.getItem(o.INTERACTION_STATUS);if(e===l.interactionTypeRedirect&&this.cacheStorage.setItem(o.REDIRECT_REQUEST,""+l.inProgress+l.resourceDelimiter+r.state),c===l.inProgress){var s=t?W.createLoginInProgressError():W.createAcquireTokenInProgressError(),u=ft(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,s,u,i);}var d=r&&r.account&&!t?r.account:this.getAccount();if(d||ge.isSSOParam(r))this.acquireTokenHelper(d,e,t,r,n,i);else{if(!t){this.logger.info("User login is required");u=ft(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,W.createUserLoginRequiredError(),u,i);}if(this.extractADALIdToken()&&!r.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken ");var h=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(h).then(function(t){a.silentLogin=!1,a.logger.info("Unified cache call is successful"),a.authResponseHandler(e,t,n);},function(o){a.silentLogin=!1,a.logger.error("Error occurred during unified cache ATS: "+o),a.acquireTokenHelper(null,e,t,r,n,i);});}else this.acquireTokenHelper(null,e,t,r,n,i);}},e.prototype.acquireTokenHelper=function(e,t,r,n,i,s){var u=this;this.cacheStorage.setItem(o.INTERACTION_STATUS,l.inProgress);var d,h,p=n.scopes?n.scopes.join(" ").toLowerCase():this.clientId.toLowerCase(),f=n&&n.authority?tt.CreateInstance(n.authority,this.config.auth.validateAuthority):this.authorityInstance;if(t===l.interactionTypePopup){try{h=this.openPopup("about:blank","msal",l.popUpWidth,l.popUpHeight),Te.trackPopup(h);}catch(e){this.logger.info(S.code+":"+S.desc),this.cacheStorage.setItem(a.ERROR,S.code),this.cacheStorage.setItem(a.ERROR_DESC,S.desc),s&&s(W.createPopupWindowError());}if(!h)return;}f.resolveEndpointsAsync(this.telemetryManager,n.correlationId).then(function(){return c.__awaiter(u,void 0,void 0,function(){var a,u,g,m,y;return c.__generator(this,function(c){switch(c.label){case 0:if(a=r?Pt:this.getTokenType(e,n.scopes,!1),u=n.redirectStartPage||window.location.href,d=new ge(f,this.clientId,a,this.getRedirectUri(n&&n.redirectUri),n.scopes,n.state,n.correlationId),this.updateCacheEntries(d,e,r,u),d.populateQueryParams(e,n),g=he.createNavigateUrl(d)+l.response_mode_fragment,t===l.interactionTypeRedirect)r||this.cacheStorage.setItem(""+o.STATE_ACQ_TOKEN+l.resourceDelimiter+n.state,d.state,this.inCookie);else{if(t!==l.interactionTypePopup)throw W.createInvalidInteractionTypeError();window.renewStates.push(d.state),window.requestType=r?l.login:l.renewToken,this.registerCallback(d.state,p,i,s);}if(this.navigateWindow(g,h),!h)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,Te.monitorWindowForHash(h,this.config.system.loadFrameTimeout,g)];case 2:return m=c.sent(),this.handleAuthenticationResponse(m),this.cacheStorage.removeItem(o.INTERACTION_STATUS),this.logger.info("Closing popup window"),this.config.framework.isAngular&&(this.broadcast("msal:popUpHashChanged",m),Te.closePopups()),[3,4];case 3:return y=c.sent(),s&&s(y),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",y.errorCode+l.resourceDelimiter+y.errorMessage):(this.cacheStorage.removeItem(o.INTERACTION_STATUS),h.close()),[3,4];case 4:return[2];}});});}).catch(function(e){u.logger.warning("could not resolve endpoints"),u.cacheStorage.resetTempCacheItems(n.state),u.authErrorHandler(t,W.createEndpointResolutionError(e.toString),ft(n.state),s),h&&h.close();});},e.prototype.ssoSilent=function(e){if(!e)throw le.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw le.createSsoSilentError();return this.acquireTokenSilent(c.__assign({},e,{scopes:[this.clientId]}));},e.prototype.acquireTokenSilent=function(e){var t=this,r=be.validateRequest(e,!1,this.clientId,l.interactionTypeSilent),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,yt.AcquireTokenSilent,this.logger),o=be.createRequestSignature(r);return new Promise(function(e,n){Te.blockReloadInHiddenIframes();var i=r.scopes.join(" ").toLowerCase(),a=r.account||t.getAccount(),c=t.cacheStorage.getItem(l.adalIdToken);if(!a&&!r.sid&&!r.loginHint&&E.isEmpty(c))return t.logger.info("User login is required"),n(W.createUserLoginRequiredError());var s=t.getTokenType(a,r.scopes,!0),u=new ge(tt.CreateInstance(r.authority,t.config.auth.validateAuthority),t.clientId,s,t.getRedirectUri(r.redirectUri),r.scopes,r.state,r.correlationId);if(ge.isSSOParam(r)||a)u.populateQueryParams(a,r,null,!0);else if(!a&&!E.isEmpty(c)){var d=ye.extractIdToken(c);t.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken "),u.populateQueryParams(a,null,d,!0);}var h,p,f=r.claimsRequest||u.claimsValue;if(!f&&!r.forceRefresh)try{p=t.getCachedToken(u,a);}catch(e){h=e;}if(p)return t.logger.info("Token is already in cache for scope:"+i),e(p),null;if(h)return t.logger.infoPii(h.errorCode+":"+h.errorMessage),n(h),null;var g=void 0;return g=f?"Skipped cache lookup since claims were given.":r.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"Token is not in cache for scope:"+i,t.logger.verbose(g),u.authorityInstance||(u.authorityInstance=r.authority?tt.CreateInstance(r.authority,t.config.auth.validateAuthority):t.authorityInstance),u.authorityInstance.resolveEndpointsAsync(t.telemetryManager,r.correlationId).then(function(){window.activeRenewals[o]?(t.logger.verbose("Renew token for scope and authority: "+o+" is in progress. Registering callback"),t.registerCallback(window.activeRenewals[o],o,e,n)):r.scopes&&r.scopes.indexOf(t.clientId)>-1&&1===r.scopes.length?(t.logger.verbose("renewing idToken"),t.silentLogin=!0,t.renewIdToken(o,e,n,a,u)):(t.logger.verbose("renewing accesstoken"),t.renewToken(o,e,n,a,u));}).catch(function(e){return t.logger.warning("could not resolve endpoints"),n(W.createEndpointResolutionError(e.toString())),null;});}).then(function(e){return t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e;}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e;});},e.prototype.openPopup=function(e,t,r,n){try{var i=window.screenLeft?window.screenLeft:window.screenX,a=window.screenTop?window.screenTop:window.screenY,c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,u=c/2-r/2+i,l=s/2-n/2+a,d=window.open(e,t,"width="+r+", height="+n+", top="+l+", left="+u+", scrollbars=yes");if(!d)throw W.createPopupWindowError();return d.focus&&d.focus(),d;}catch(e){throw this.logger.error("error opening popup "+e.message),this.cacheStorage.removeItem(o.INTERACTION_STATUS),W.createPopupWindowError(e.toString());}},e.prototype.loadIframeTimeout=function(e,t,r){return c.__awaiter(this,void 0,void 0,function(){var n,i,a,s,u;return c.__generator(this,function(c){switch(c.label){case 0:return n=window.activeRenewals[r],this.logger.verbose("Set loading state to pending for: "+r+":"+n),this.cacheStorage.setItem(""+o.RENEW_STATUS+l.resourceDelimiter+n,l.inProgress),this.config.system.navigateFrameWait?[4,Te.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return a=c.sent(),[3,3];case 2:a=Te.loadFrameSync(e,t,this.logger),c.label=3;case 3:i=a,c.label=4;case 4:return c.trys.push([4,6,,7]),[4,Te.monitorWindowForHash(i.contentWindow,this.config.system.loadFrameTimeout,e,!0)];case 5:return(s=c.sent())&&this.handleAuthenticationResponse(s),[3,7];case 6:throw u=c.sent(),this.cacheStorage.getItem(""+o.RENEW_STATUS+l.resourceDelimiter+n)===l.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+r+":"+n),n&&window.callbackMappedToRenewStates[n]&&window.callbackMappedToRenewStates[n](null,u),this.cacheStorage.removeItem(""+o.RENEW_STATUS+l.resourceDelimiter+n)),Te.removeHiddenIframe(i),u;case 7:return Te.removeHiddenIframe(i),[2];}});});},e.prototype.navigateWindow=function(e,t){if(!e||E.isEmpty(e))throw this.logger.info("Navigate url is empty"),w.createUnexpectedError("Navigate url is empty");var r=t||window,n=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(n),r.location.assign(e);},e.prototype.registerCallback=function(e,t,r,n){var o=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:n}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,n){window.activeRenewals[t]=null;for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i){try{if(n)window.promiseMappedToRenewStates[e][i].reject(n);else{if(!r)throw o.cacheStorage.resetTempCacheItems(e),w.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(r);}}catch(e){o.logger.warning(e);}}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null;});},e.prototype.logout=function(e){var t=this,r=e||u.createNewGuid(),n=this.telemetryManager.createAndStartApiEvent(r,yt.Logout,this.logger);this.clearCache(),this.account=null;var o="";this.getPostLogoutRedirectUri()&&(o="post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri())),this.authorityInstance.resolveEndpointsAsync(this.telemetryManager,r).then(function(e){var i=e.EndSessionEndpoint?e.EndSessionEndpoint+"?"+o:t.authority+"oauth2/v2.0/logout?"+o;t.telemetryManager.stopAndFlushApiEvent(r,n,!0),t.navigateWindow(i);}).catch(function(e){t.telemetryManager.stopAndFlushApiEvent(r,n,!1,e.errorCode);});},e.prototype.clearCache=function(){window.renewStates=[];for(var e=this.cacheStorage.getAllAccessTokens(l.clientId,l.homeAccountIdentifier),t=0;t<e.length;t++){this.cacheStorage.removeItem(JSON.stringify(e[t].key));}this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie();},e.prototype.clearCacheForScope=function(e){for(var t=this.cacheStorage.getAllAccessTokens(l.clientId,l.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&this.cacheStorage.removeItem(JSON.stringify(n.key));}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),he.urlContainsHash(e);},e.prototype.processCallBack=function(e,t,r){var o,i;this.logger.info("Processing the callback from redirect response"),t||(t=this.getResponseState(e));try{o=this.saveTokenFromHash(e,t);}catch(e){i=e;}try{this.cacheStorage.clearMsalCookie(t.state);var a=this.getAccountState(t.state);if(o){if(t.requestType===l.renewToken||o.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("acquiring token interactive in progress"),o.tokenType=n.ACCESS_TOKEN):t.requestType===l.login&&(o.tokenType=n.ID_TOKEN),!r)return void(this.redirectResponse=o);}else if(!r)return this.redirectResponse=ft(a),this.redirectError=i,void this.cacheStorage.resetTempCacheItems(t.state);r(o,i);}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),W.createErrorInCallbackFunction(e.toString());}},e.prototype.handleAuthenticationResponse=function(e){var t=e||window.location.hash,r=this.getResponseState(t),n=window.callbackMappedToRenewStates[r.state];this.processCallBack(t,r,n),Te.closePopups();},e.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),window.location.hash="";var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){var r=this.cacheStorage.getItem(""+o.LOGIN_REQUEST+l.resourceDelimiter+t.state,this.inCookie),n=he.getCurrentUrl();if(!r||"null"===r)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void(window.location.href="/");if(n!==r)return void(r.indexOf("#")>-1?(this.logger.info("loginRequestUrl contains hash, processing response hash immediately then redirecting"),this.processCallBack(e,t,null),window.location.href=r):window.location.href=""+r+e);}this.processCallBack(e,t,null);},e.prototype.getResponseState=function(e){var t,r=he.deserializeHash(e);if(!r)throw w.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty(n.STATE))throw w.createUnexpectedError("Hash does not contain state.");var i=be.parseLibraryState(r.state);if((t={requestType:l.unknown,state:r.state,timestamp:i.ts,method:i.method,stateMatch:!1}).state===this.cacheStorage.getItem(""+o.STATE_LOGIN+l.resourceDelimiter+t.state,this.inCookie)||t.state===this.silentAuthenticationState)return t.requestType=l.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(""+o.STATE_ACQ_TOKEN+l.resourceDelimiter+t.state,this.inCookie))return t.requestType=l.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){t.requestType=window.requestType;for(var a=window.renewStates,c=0;c<a.length;c++){if(a[c]===t.state){t.stateMatch=!0;break;}}}return t;},e.prototype.getCachedToken=function(e,t){var r=null,o=e.scopes,i=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null);if(0===i.length)return null;var a=[];if(e.authority){for(c=0;c<i.length;c++){u=(s=i[c]).key.scopes.split(" ");de.containsScope(u,o)&&he.CanonicalizeUri(s.key.authority)===e.authority&&a.push(s);}if(0===a.length)return null;if(1!==a.length)throw W.createMultipleMatchingTokensInCacheError(o.toString());r=a[0];}else{for(var c=0;c<i.length;c++){var s,u=(s=i[c]).key.scopes.split(" ");de.containsScope(u,o)&&a.push(s);}if(1===a.length)r=a[0],e.authorityInstance=tt.CreateInstance(r.key.authority,this.config.auth.validateAuthority);else{if(a.length>1)throw W.createMultipleMatchingTokensInCacheError(o.toString());var l=this.getUniqueAuthority(i,"authority");if(l.length>1)throw W.createMultipleAuthoritiesInCacheError(o.toString());e.authorityInstance=tt.CreateInstance(l[0],this.config.auth.validateAuthority);}}if(null!=r){var d=Number(r.value.expiresIn),h=this.config.system.tokenRenewalOffsetSeconds||300;if(d&&d>_e.now()+h){var p=new ve(r.value.idToken);if(!t&&!(t=this.getAccount()))throw w.createUnexpectedError("Account should not be null here.");var f=this.getAccountState(e.state),g={uniqueId:"",tenantId:"",tokenType:r.value.idToken===r.value.accessToken?n.ID_TOKEN:n.ACCESS_TOKEN,idToken:p,idTokenClaims:p.claims,accessToken:r.value.accessToken,scopes:r.key.scopes.split(" "),expiresOn:new Date(1e3*d),account:t,accountState:f,fromCache:!0};return Se.setResponseIdToken(g,p),g;}return this.cacheStorage.removeItem(JSON.stringify(a[0].key)),null;}return null;},e.prototype.getUniqueAuthority=function(e,t){var r=[],n=[];return e.forEach(function(e){e.key.hasOwnProperty(t)&&-1===n.indexOf(e.key[t])&&(n.push(e.key[t]),r.push(e.key[t]));}),r;},e.prototype.extractADALIdToken=function(){var e=this.cacheStorage.getItem(l.adalIdToken);return E.isEmpty(e)?null:ye.extractIdToken(e);},e.prototype.renewToken=function(e,t,r,n,o){this.logger.verbose("renewToken is called for scope and authority: "+e);var i=Te.generateFrameName(m,e),a=Te.addHiddenIFrame(i,this.logger);this.updateCacheEntries(o,n,!1),this.logger.verbose("Renew token Expected state: "+o.state);var c=he.urlRemoveQueryStringParameter(he.createNavigateUrl(o),l.prompt)+l.prompt_none+l.response_mode_fragment;window.renewStates.push(o.state),window.requestType=l.renewToken,this.registerCallback(o.state,e,t,r),this.logger.infoPii("Navigate to:"+c),a.src="about:blank",this.loadIframeTimeout(c,i,e).catch(function(e){return r(e);});},e.prototype.renewIdToken=function(e,t,r,n,o){this.logger.info("renewidToken is called");var i=Te.generateFrameName(g,e),a=Te.addHiddenIFrame(i,this.logger);this.updateCacheEntries(o,n,!1),this.logger.verbose("Renew Idtoken Expected state: "+o.state);var c=he.urlRemoveQueryStringParameter(he.createNavigateUrl(o),l.prompt)+l.prompt_none+l.response_mode_fragment;this.silentLogin?(window.requestType=l.login,this.silentAuthenticationState=o.state):(window.requestType=l.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,e,t,r),this.logger.infoPii("Navigate to:"+c),a.src="about:blank",this.loadIframeTimeout(c,i,e).catch(function(e){return r(e);});},e.prototype.saveAccessToken=function(e,t,r,o,i){var a,s,u=c.__assign({},e),l=new me(o);if(r.hasOwnProperty(n.SCOPE)){for(var d=(a=r[n.SCOPE]).split(" "),h=this.cacheStorage.getAllAccessTokens(this.clientId,t),p=0;p<h.length;p++){var f=h[p];if(f.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var g=f.key.scopes.split(" ");de.isIntersectingScopes(g,d)&&this.cacheStorage.removeItem(JSON.stringify(f.key));}}var m=_e.parseExpiresIn(r[n.EXPIRES_IN]);s=be.parseLibraryState(r[n.STATE]).ts+m;var y=new pe(t,this.clientId,a,l.uid,l.utid),v=new fe(r[n.ACCESS_TOKEN],i.rawIdToken,s.toString(),o);this.cacheStorage.setItem(JSON.stringify(y),JSON.stringify(v)),u.accessToken=r[n.ACCESS_TOKEN],u.scopes=d;}else{a=this.clientId;y=new pe(t,this.clientId,a,l.uid,l.utid);s=Number(i.expiration);v=new fe(r[n.ID_TOKEN],r[n.ID_TOKEN],s.toString(),o);this.cacheStorage.setItem(JSON.stringify(y),JSON.stringify(v)),u.scopes=[a],u.accessToken=r[n.ID_TOKEN];}return s?u.expiresOn=new Date(1e3*s):this.logger.error("Could not parse expiresIn parameter"),u;},e.prototype.saveTokenFromHash=function(e,t){this.logger.info("State status:"+t.stateMatch+"; Request type:"+t.requestType);var r,c={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},s=he.deserializeHash(e),u="",d="",h=null;if(s.hasOwnProperty(n.ERROR_DESCRIPTION)||s.hasOwnProperty(n.ERROR)){if(this.logger.infoPii("Error :"+s[n.ERROR]+"; Error description:"+s[n.ERROR_DESCRIPTION]),this.cacheStorage.setItem(a.ERROR,s[n.ERROR]),this.cacheStorage.setItem(a.ERROR_DESC,s[n.ERROR_DESCRIPTION]),t.requestType===l.login&&(this.cacheStorage.setItem(a.LOGIN_ERROR,s[n.ERROR_DESCRIPTION]+":"+s[n.ERROR]),u=we.generateAuthorityKey(t.state)),t.requestType===l.renewToken){u=we.generateAuthorityKey(t.state);var p=this.getAccount(),f=void 0;f=p&&!E.isEmpty(p.homeAccountIdentifier)?p.homeAccountIdentifier:l.no_account,d=we.generateAcquireTokenAccountKey(f,t.state);}var g=s[n.ERROR],m=s[n.ERROR_DESCRIPTION];r=pt.isInteractionRequiredError(g)||pt.isInteractionRequiredError(m)?new pt(s[n.ERROR],s[n.ERROR_DESCRIPTION]):new ut(s[n.ERROR],s[n.ERROR_DESCRIPTION]);}else if(t.stateMatch){this.logger.info("State is right"),s.hasOwnProperty(n.SESSION_STATE)&&this.cacheStorage.setItem(""+o.SESSION_STATE+l.resourceDelimiter+t.state,s[n.SESSION_STATE]),c.accountState=this.getAccountState(t.state);var y="";if(s.hasOwnProperty(n.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),c.accessToken=s[n.ACCESS_TOKEN],s.hasOwnProperty(n.SCOPE)&&(c.scopes=s[n.SCOPE].split(" ")),s.hasOwnProperty(n.ID_TOKEN)?(h=new ve(s[n.ID_TOKEN]),c.idToken=h,c.idTokenClaims=h.claims):(h=new ve(this.cacheStorage.getItem(i.IDTOKEN)),c=Se.setResponseIdToken(c,h));var v=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,h);if(!s.hasOwnProperty(n.CLIENT_INFO))throw this.logger.warning("ClientInfo not received in the response from AAD"),W.createClientInfoNotPopulatedError("ClientInfo not received in the response from the server");y=s[n.CLIENT_INFO],c.account=Ee.createAccount(h,new me(y));var I=void 0;I=c.account&&!E.isEmpty(c.account.homeAccountIdentifier)?c.account.homeAccountIdentifier:l.no_account,d=we.generateAcquireTokenAccountKey(I,t.state);var T=we.generateAcquireTokenAccountKey(l.no_account,t.state),_=this.cacheStorage.getItem(d),b=void 0;E.isEmpty(_)?E.isEmpty(this.cacheStorage.getItem(T))||(c=this.saveAccessToken(c,v,s,y,h)):(b=JSON.parse(_),c.account&&b&&Ee.compareAccounts(c.account,b)?(c=this.saveAccessToken(c,v,s,y,h),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"));}if(s.hasOwnProperty(n.ID_TOKEN)){this.logger.info("Fragment has id token"),h=new ve(s[n.ID_TOKEN]),c=Se.setResponseIdToken(c,h),s.hasOwnProperty(n.CLIENT_INFO)?y=s[n.CLIENT_INFO]:this.logger.warning("ClientInfo not received in the response from AAD");v=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,h);this.account=Ee.createAccount(h,new me(y)),c.account=this.account,h&&h.nonce?h.nonce!==this.cacheStorage.getItem(""+o.NONCE_IDTOKEN+l.resourceDelimiter+t.state,this.inCookie)?(this.account=null,this.cacheStorage.setItem(a.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+this.cacheStorage.getItem(""+o.NONCE_IDTOKEN+l.resourceDelimiter+t.state,this.inCookie)+",Actual Nonce: "+h.nonce),this.logger.error("Nonce Mismatch.Expected Nonce: "+this.cacheStorage.getItem(""+o.NONCE_IDTOKEN+l.resourceDelimiter+t.state,this.inCookie)+",Actual Nonce: "+h.nonce),r=W.createNonceMismatchError(this.cacheStorage.getItem(""+o.NONCE_IDTOKEN+l.resourceDelimiter+t.state,this.inCookie),h.nonce)):(this.cacheStorage.setItem(i.IDTOKEN,s[n.ID_TOKEN]),this.cacheStorage.setItem(i.CLIENT_INFO,y),this.saveAccessToken(c,v,s,y,h)):(u=t.state,d=t.state,this.logger.error("Invalid id_token received in the response"),r=W.createInvalidIdTokenError(h),this.cacheStorage.setItem(a.ERROR,r.errorCode),this.cacheStorage.setItem(a.ERROR_DESC,r.errorMessage));}}else{u=t.state,d=t.state;var S=this.cacheStorage.getItem(""+o.STATE_LOGIN+l.resourceDelimiter+t.state,this.inCookie);this.logger.error("State Mismatch.Expected State: "+S+",Actual State: "+t.state),r=W.createInvalidStateError(t.state,S),this.cacheStorage.setItem(a.ERROR,r.errorCode),this.cacheStorage.setItem(a.ERROR_DESC,r.errorMessage);}if(this.cacheStorage.removeItem(""+o.RENEW_STATUS+l.resourceDelimiter+t.state),this.cacheStorage.resetTempCacheItems(t.state),this.inCookie&&(this.cacheStorage.setItemCookie(u,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw r;if(!c)throw w.createUnexpectedError("Response is null");return c;},e.prototype.populateAuthority=function(e,t,r,n){var o=we.generateAuthorityKey(e),i=r.getItem(o,t);return E.isEmpty(i)?i:he.replaceTenantPath(i,n.tenantId);},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(i.IDTOKEN),t=this.cacheStorage.getItem(i.CLIENT_INFO);if(!E.isEmpty(e)&&!E.isEmpty(t)){var r=new ve(e),n=new me(t);return this.account=Ee.createAccount(r,n),this.account;}return null;},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf(l.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1);}return e;},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(l.clientId,l.homeAccountIdentifier),r=0;r<t.length;r++){var n=new ve(t[r].value.idToken),o=new me(t[r].value.homeAccountIdentifier),i=Ee.createAccount(n,o);e.push(i);}return this.getUniqueAccounts(e);},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n){e[n].homeAccountIdentifier&&-1===t.indexOf(e[n].homeAccountIdentifier)&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));}return r;},e.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r);},e.prototype.getCachedTokenInternal=function(e,t,r,n){var o=t||this.getAccount();if(!o)return null;var i=this.authorityInstance?this.authorityInstance:tt.CreateInstance(this.authority,this.config.auth.validateAuthority),a=this.getTokenType(o,e,!0),c=new ge(i,this.clientId,a,this.getRedirectUri(),e,r,n);return this.getCachedToken(c,t);},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++){if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;}if(this.config.framework.protectedResourceMap.size>0)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(e.indexOf(o)>-1)return this.config.framework.protectedResourceMap.get(o);}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?he.getHostFromUri(e)===he.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId);},e.prototype.getLoginInProgress=function(){return this.cacheStorage.getItem(o.INTERACTION_STATUS)===l.inProgress;},e.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(o.INTERACTION_STATUS,l.inProgress):this.cacheStorage.removeItem(o.INTERACTION_STATUS);},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e);},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(o.INTERACTION_STATUS)===l.inProgress;},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e);},e.prototype.getLogger=function(){return this.logger;},e.prototype.setLogger=function(e){this.logger=e;},e.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri);},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri;},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw le.createNoSetConfigurationError();return this.config;},e.prototype.getTokenType=function(e,t,r){return r?Ee.compareAccounts(e,this.getAccount())?t.indexOf(this.config.auth.clientId)>-1?Pt:Nt:t.indexOf(this.config.auth.clientId)>-1?Pt:xt:Ee.compareAccounts(e,this.getAccount())?t.indexOf(this.clientId)>-1?Pt:Nt:xt;},e.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):l.no_account,n=we.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e));},e.prototype.setAuthorityCache=function(e,t){var r=we.generateAuthorityKey(e);this.cacheStorage.setItem(r,he.CanonicalizeUri(t),this.inCookie);},e.prototype.updateCacheEntries=function(e,t,r,n){r?(this.cacheStorage.setItem(""+o.LOGIN_REQUEST+l.resourceDelimiter+e.state,n,this.inCookie),this.cacheStorage.setItem(""+o.STATE_LOGIN+l.resourceDelimiter+e.state,e.state,this.inCookie)):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(""+o.NONCE_IDTOKEN+l.resourceDelimiter+e.state,e.nonce,this.inCookie);},e.prototype.getAccountId=function(e){return E.isEmpty(e.homeAccountIdentifier)?l.no_account:e.homeAccountIdentifier;},e.prototype.buildIDTokenRequest=function(e){return{scopes:[this.clientId],authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId};},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return Ot.getTelemetrymanagerStub(t);var r=e.applicationName,n=e.applicationVersion,o=e.telemetryEmitter;if(!r||!n||!o)throw le.createTelemetryConfigError(e);return new Ot({platform:{applicationName:r,applicationVersion:n},clientId:t},o);},e;}(),Lt=r("ifNO"),qt=r("3J71"),Dt=r("zQSw"),jt=r("Y1Np"),Ht=r("xVGs");r.d(t,"MsalAuthenticationService",function(){return Ft;});var Mt=["service::api.fl.spaces.skype.com::MBI_SSL"],Ft=function(){function e(e,t,r,n){var o,i,a=this;this._logger=t,this.tokenExpireOffsetSeconds=r,this._coreSettings=n,this.handleCallback=function(){a._userAgentApplication.handleRedirectCallback(function(e,t){if(e)return a._logger.error("Unexpected error callback: "+e.errorMessage),void a._loginRequired.next(!0);a._loginRequired.next(!t);});},this._logger.log("msal service created"),this._clientId=e.clientId;var c=(null===(o=this._coreSettings)||void 0===o?void 0:o.get(Dt.a.Auth))||{},u=c.redirectUrlPath,l=void 0===u?"":u,d=c.instanceUrl,h=void 0===d?"https://login.microsoftonline.com/":d,p=c.audience,f=void 0===p?"common":p;this._userAgentApplication=new Ut({auth:{clientId:this._clientId,authority:""+h+f,redirectUri:Gt(e,l||""),navigateToLoginRequestUrl:!0},cache:{cacheLocation:(null===(i=null==e?void 0:e.webAuth)||void 0===i?void 0:i.cacheLocation)||"localStorage",storeAuthStateInCookie:!0},system:{logger:new rt(function(e,t){switch(e){case Xe.Error:a._logger.error(t);break;case Xe.Warning:a._logger.warn(t);break;case Xe.Verbose:default:a._logger.log(t);}},{level:Xe.Verbose,piiLoggingEnabled:!1}),tokenRenewalOffsetSeconds:r}}),this._loginRequired=new s.a(!this._userAgentApplication.getAccount()),this.handleCallback();}return Object.defineProperty(e.prototype,"isLoginRequired",{get:function get(){return this._loginRequired.asObservable();},enumerable:!0,configurable:!0}),e.prototype.loginRedirect=function(){this._userAgentApplication.loginRedirect();},e.prototype.getUser=function(){var e=this._userAgentApplication.getAccount();if(!e)throw Object(Lt.a)(qt.d.Authentication,qt.c.ThirdPartyError,"getUser",void 0,"getUser: MSAL account not found");var t={profile:(null==e?void 0:e.idTokenClaims)||(null==e?void 0:e.idToken),userName:null==e?void 0:e.name};return Object(c.__assign)(Object(c.__assign)({},t),{isAuthenticated:!0});},e.prototype.clearCacheForScope=function(e){this._userAgentApplication.clearCacheForScope(e);},e.prototype.acquireToken=function(e,t){return Object(c.__awaiter)(this,void 0,Promise,function(){var r,n,o,i,a,s,u,l=this;return Object(c.__generator)(this,function(d){switch(d.label){case 0:r=[Wt(e,this._clientId)],n={scopes:r},d.label=1;case 1:return d.trys.push([1,3,,4]),[4,this._userAgentApplication.acquireTokenSilent(n).catch(function(r){var o=r.errorCode,i=r.errorMessage,a=Object(c.__rest)(r,["errorCode","errorMessage"]);l.handleError(e,n,o,i,a,t);})];case 2:if(!(o=d.sent()))throw Kt("Invalid authResponse received from msal for resource::"+e,qt.c.InvalidResponse);return[2,this.mapAuthResponse(o,e)];case 3:throw i=d.sent(),a=i.code,s=void 0===a?qt.c.ThirdPartyError:a,u=i.message,Object(Lt.a)(qt.d.Authentication,s,"msal-service",void 0,"error thrown for resource::"+e+"::error::"+u);case 4:return[2];}});});},e.prototype.handleError=function(e,t,r,n,o,i){var a,c=this;throw(r.indexOf("login_required")>-1||r.indexOf("consent_required")>-1||r.indexOf("interaction_required")>-1)&&(this._loginRequired.next(!0),this._logger.error("interactive flow using a popUp window. Error - ["+r+"] ["+n+"]"),i&&!1===i.loginRedirect&&this._userAgentApplication.acquireTokenPopup(t).then(function(t){return c._loginRequired.next(!1),c.mapAuthResponse(t,e);}).catch(function(e){throw Kt((null==e?void 0:e.message)||"invalid response from acquireTokenPopup - "+Object(Ht.c)(e),qt.c.InvalidResponse);}),null===(a=this._userAgentApplication)||void 0===a||a.acquireTokenRedirect(t)),Kt(r+"::"+n+"::"+Object(Ht.c)(o),r);},e.prototype.mapAuthResponse=function(e,t){var r=e.expiresOn,n=e.tokenType,o=e.accessToken,i=e.idToken.rawIdToken,a="id_token"===n?i:o,c=r&&r.valueOf()>=Date.now()+this.tokenExpireOffsetSeconds*jt.c.MILLI_PER_SECOND;if(a&&c)return{token:Mt.indexOf(t)>-1?encodeURI(a):a,expires:r.valueOf()/jt.c.MILLI_PER_SECOND};throw Object(Lt.a)(qt.d.Authentication,qt.c.InvalidResponse,"msal service",void 0,"Msal::AcquireToken::Invalid-Token::"+t+", token::"+!!a+"::valid::"+!!c);},e;}(),Kt=function Kt(e,t){var r=new Error(e);return Object.assign(r,{code:t});},Gt=function Gt(e,t){return e.origin+"/"+t;},Wt=function Wt(e,t){return e.startsWith("service::")||e===t?e:e+(e.endsWith("/")?".default":"/.default");};}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/msal-service-7f260a790df63e61.js.map